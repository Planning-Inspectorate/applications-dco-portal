name: PR â€“ E2E tests (Cypress)

trigger: none

pr:
  branches:
    include:
      - '*'

pool:
  vmImage: ubuntu-latest

variables:
  NODE_VERSION: '20'

jobs:
  - job: e2e
    displayName: E2E tests (Cypress)
    steps:
      - checkout: self
        clean: true

      - task: NodeTool@0
        inputs:
          versionSpec: $(NODE_VERSION)
        displayName: Install Node.js

      - script: |
          docker version
          docker compose version
        displayName: Verify Docker

      - script: |
          make setup
        displayName: Setup environment (Docker + DB)

      - script: |
          make headless
        displayName: Run Cypress E2E tests
